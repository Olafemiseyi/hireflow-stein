<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HireFlow - Job Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="container mt-5">
      <a href="/jobs.html" class="btn btn-secondary mb-3">Back to Jobs</a>
      <div class="card">
        <img src="" id="logo" class="card-img-top" style="height: 200px; object-fit: cover;">
        <div class="card-body">
          <h1 id="title"></h1>
          <p id="company"></p>
          <p id="location"></p>
          <p id="type"></p>
          <p id="salary"></p>
          <p id="description"></p>
          <a id="apply-link" class="btn btn-primary mt-3">Apply Now</a>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const jobId = urlParams.get('id');
      async function loadJobDetails() {
        try {
          const response = await fetch(`/.netlify/functions/stein?sheet=Jobs&Job ID=${jobId}`);
          if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
          const job = (await response.json())[0];
          document.getElementById('logo').src = job[8] || 'https://via.placeholder.com/40x40.png?text=?';
          document.getElementById('title').textContent = job[1] || 'Untitled';
          document.getElementById('company').textContent = job[2] || 'N/A';
          document.getElementById('location').textContent = job[3] || 'N/A';
          document.getElementById('type').textContent = job[4] || 'N/A';
          document.getElementById('salary').textContent = job[5] || 'N/A';
          document.getElementById('description').textContent = job[6] || 'N/A';
          document.getElementById('apply-link').href = job[7] || '#';
        } catch (error) {
          console.error('Error:', error);
          document.querySelector('.card-body').innerHTML = '<p>Failed to load job details.</p>';
        }
      }
      loadJobDetails();
    </script>
  </body>
  </html>
