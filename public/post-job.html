<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HireFlow - Post a Job</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="text-center mb-4">Post a Job</h1>
      <form id="post-job-form" class="row g-3">
        <div class="col-md-6">
          <label for="job-title" class="form-label">Job Title</label>
          <input type="text" class="form-control" id="job-title" required>
        </div>
        <div class="col-md-6">
          <label for="company" class="form-label">Company</label>
          <input type="text" class="form-control" id="company" required>
        </div>
        <div class="col-md-6">
          <label for="location" class="form-label">Location</label>
          <input type="text" class="form-control" id="location" required>
        </div>
        <div class="col-md-6">
          <label for="job-type" class="form-label">Job Type</label>
          <select class="form-control" id="job-type" required>
            <option value="">Select Job Type</option>
            <option value="Full-Time">Full Time</option>
            <option value="Part-Time">Part Time</option>
            <option value="Contract">Contract</option>
            <option value="Internship">Internship</option>
          </select>
        </div>
        <div class="col-md-6">
          <label for="salary" class="form-label">Salary</label>
          <input type="text" class="form-control" id="salary">
        </div>
        <div class="col-12">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" id="description" rows="5"></textarea>
        </div>
        <div class="col-md-6">
          <label for="apply-link" class="form-label">Apply Link</label>
          <input type="url" class="form-control" id="apply-link">
        </div>
        <div class="col-md-6">
          <label for="logo-url" class="form-label">Logo URL</label>
          <input type="url" class="form-control" id="logo-url">
        </div>
        <div class="col-12 text-center">
          <button type="submit" class="btn btn-primary">Submit Job</button>
        </div>
      </form>
      <div id="form-message" class="text-center mt-3"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.getElementById('post-job-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = {
          'Job Title': document.getElementById('job-title').value,
          'Company': document.getElementById('company').value,
          'Location': document.getElementById('location').value,
          'Job Type': document.getElementById('job-type').value,
          'Salary': document.getElementById('salary').value,
          'Description': document.getElementById('description').value,
          'Apply Link': document.getElementById('apply-link').value,
          'Logo URL': document.getElementById('logo-url').value,
          'Posted Date': new Date().toISOString().split('T')[0], // YYYY-MM-DD
          'Deadline': '' // Optional
        };
        try {
          const response = await fetch('/.netlify/functions/stein?sheet=Jobs', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
          const result = await response.json();
          document.getElementById('form-message').innerHTML = `<p class="text-success">Job posted successfully! Job ID: ${result.jobId}</p>`;
          document.getElementById('post-job-form').reset();
        } catch (error) {
          console.error('Error:', error);
          document.getElementById('form-message').innerHTML = '<p class="text-danger">Failed to post job. Please try again.</p>';
        }
      });
    </script>
  </body>
  </html>
